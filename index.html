<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZMF - æ ¸å¿ƒç³»ç»Ÿ</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            background: #0a0a1a;
            color: #4af;
            font-family: 'Courier New', monospace;
            overflow: hidden;
            height: 100vh;
        }
        
        #main-container {
            position: relative;
            width: 100%;
            height: 100%;
        }
        
        /* èŠ¯ç‰‡æ ·å¼ - æœ€å…ˆåŠ è½½ */
        #chip {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 120px;
            height: 120px;
            background: #001133;
            border: 2px solid #004488;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 100;
            box-shadow: 0 0 0 rgba(68, 170, 255, 0);
            animation: 
                chipAppear 2s ease-out forwards,
                chipGlow 3s ease-in-out infinite 2s;
        }
        
        @keyframes chipAppear {
            0% { opacity: 0; transform: translate(-50%, -50%) scale(0.3); }
            100% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
        }
        
        @keyframes chipGlow {
            0%, 100% { box-shadow: 0 0 10px rgba(68, 170, 255, 0.5); }
            50% { box-shadow: 0 0 30px rgba(68, 170, 255, 0.8); }
        }
        
        #chip-text {
            font-size: 2.5rem;
            font-weight: bold;
            color: #4af;
            text-shadow: 0 0 10px #4af;
            animation: textPulse 3s ease-in-out infinite 2s;
        }
        
        @keyframes textPulse {
            0%, 100% { opacity: 0.8; text-shadow: 0 0 10px #4af; }
            50% { opacity: 1; text-shadow: 0 0 20px #4af; }
        }
        
        /* æ¨¡å—æ ·å¼ - å»¶è¿ŸåŠ è½½ */
        .module {
            position: absolute;
            width: 120px;
            height: 120px;
            background: #001133;
            border: 2px solid #003366;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            z-index: 50;
            opacity: 0;
            transform: scale(0.5);
            transition: all 0.8s ease-out;
            box-shadow: 0 0 10px rgba(0, 51, 102, 0.5);
        }
        
        .module:hover {
            border-color: #4af;
            box-shadow: 0 0 20px rgba(68, 170, 255, 0.7);
        }
        
        .module-icon {
            font-size: 2rem;
            margin-bottom: 8px;
        }
        
        .module-title {
            font-size: 0.9rem;
        }
        
        /* çº¿è·¯æ ·å¼ */
        .circuit-line {
            stroke: #003366;
            stroke-width: 2.4;
            stroke-linecap: round;
            fill: none;
            animation: lineDraw 1.5s ease-out forwards;
            opacity: 0;
        }
        
        @keyframes lineDraw {
            0% { stroke-dashoffset: 1000; opacity: 0; }
            70% { opacity: 0.8; }
            100% { stroke-dashoffset: 0; opacity: 1; }
        }
        
        .active-line {
            stroke: #4af;
            animation: 
                lineDraw 1.5s ease-out forwards,
                lineGlow 2s ease-in-out infinite;
        }
        
        @keyframes lineGlow {
            0%, 100% { stroke-opacity: 0.8; }
            50% { stroke-opacity: 1; }
        }
        
        .end-point {
            fill: #003366;
            stroke: #003366;
            stroke-width: 1;
            r: 4;
            opacity: 0;
            animation: pointAppear 1s ease-out forwards;
        }
        
        @keyframes pointAppear {
            0% { r: 0; opacity: 0; }
            100% { r: 4; opacity: 1; }
        }
        
        .active-point {
            fill: #4af;
            stroke: #4af;
            filter: drop-shadow(0 0 5px #4af);
        }
        
        /* åŠ è½½åŠ¨ç”» */
        #loader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #0a0a1a;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            transition: opacity 1.5s ease-out;
        }
        
        .loader-text {
            color: #4af;
            font-size: 1.2rem;
            opacity: 0;
            animation: fadeInOut 2s ease-in-out infinite;
        }
        
        @keyframes fadeInOut {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 1; }
        }
    </style>
</head>
<body>
    <div id="loader">
        <div class="loader-text">æ ¸å¿ƒç³»ç»Ÿå¯åŠ¨ä¸­...</div>
    </div>
    
    <div id="main-container">
        <svg id="circuit-svg" xmlns="http://www.w3.org/2000/svg"></svg>
        
        <div id="chip">
            <div id="chip-text">ZMF</div>
        </div>
        
        <div class="module" id="tools-module">
            <div class="module-icon">ğŸ”§</div>
            <div class="module-title">å·¥å…·é›†</div>
        </div>
        
        <div class="module" id="games-module">
            <div class="module-icon">ğŸ®</div>
            <div class="module-title">æ¸¸æˆåŒº</div>
        </div>
        
        <div class="module" id="about-module">
            <div class="module-icon">ğŸ‘¤</div>
            <div class="module-title">å…³äºæˆ‘</div>
        </div>
        
        <div class="module" id="settings-module">
            <div class="module-icon">âš™ï¸</div>
            <div class="module-title">è®¾ç½®</div>
        </div>
    </div>

    <script>
        // ä¸¥æ ¼æŒ‰é˜¶æ®µåŠ è½½
        document.addEventListener('DOMContentLoaded', async function() {
            // 1. é¦–å…ˆåªæ˜¾ç¤ºèŠ¯ç‰‡
            const chip = document.getElementById('chip');
            chip.style.opacity = 1;
            
            // 2. å»¶è¿ŸåŠ è½½å…¶ä»–å…ƒç´ 
            setTimeout(async () => {
                // åˆå§‹åŒ–ç”µè·¯ç³»ç»Ÿ
                await initCircuitSystem();
                
                // éšè—åŠ è½½ç•Œé¢
                const loader = document.getElementById('loader');
                loader.style.opacity = '0';
                setTimeout(() => loader.remove(), 1500);
                
            }, 1500);
        });
        
        async function initCircuitSystem() {
            // ç¡®ä¿èŠ¯ç‰‡å®Œå…¨åŠ è½½
            const chip = document.getElementById('chip');
            const chipRect = chip.getBoundingClientRect();
            const chipCenter = {
                x: chipRect.left + chipRect.width / 2,
                y: chipRect.top + chipRect.height / 2
            };
            
            // 1. å®šä½å››ä¸ªæ¨¡å—åˆ°å››ä¸ªè±¡é™
            positionModules(chipCenter);
            
            // 2. ç”Ÿæˆå£®è§‚çš„éäº¤å‰ç”µè·¯ç½‘ç»œ
            generateCircuitNetwork(chipCenter);
            
            // 3. æ·»åŠ äº¤äº’æ•ˆæœ
            setupInteractions();
            
            // 4. éšæœºæ¿€æ´»åŠ¨ç”»
            startRandomActivations();
        }
        
        function positionModules(chipCenter) {
            const modules = [
                document.getElementById('tools-module'),
                document.getElementById('games-module'),
                document.getElementById('about-module'),
                document.getElementById('settings-module')
            ];
            
            const radius = Math.min(window.innerWidth, window.innerHeight) * 0.35;
            const angles = [
                Math.PI * 1.25,  // å·¦ä¸Š
                Math.PI * 0.75,  // å³ä¸Š
                Math.PI * 1.75,  // å·¦ä¸‹
                Math.PI * 0.25   // å³ä¸‹
            ];
            
            // æ¯ä¸ªæ¨¡å—åˆ†é…åˆ°ä¸åŒè±¡é™
            modules.forEach((module, i) => {
                // éšæœºè§’åº¦å˜åŒ– (Â±15åº¦å†…)
                const angleVariation = (Math.random() - 0.5) * Math.PI/6;
                const angle = angles[i] + angleVariation;
                
                // éšæœºè·ç¦»å˜åŒ–
                const distance = radius * (0.8 + Math.random() * 0.4);
                
                const x = chipCenter.x + Math.cos(angle) * distance;
                const y = chipCenter.y + Math.sin(angle) * distance;
                
                module.style.left = `${x - 60}px`;
                module.style.top = `${y - 60}px`;
                
                // å»¶è¿Ÿæ˜¾ç¤ºæ¨¡å—
                setTimeout(() => {
                    module.style.opacity = '1';
                    module.style.transform = 'scale(1)';
                }, 800 + i * 300);
            });
        }
        
        function generateCircuitNetwork(chipCenter) {
            const svg = document.getElementById('circuit-svg');
            const containerWidth = window.innerWidth;
            const containerHeight = window.innerHeight;
            
            // èŠ¯ç‰‡å››ä¸ªè¾¹çš„å‡ºå‘ç‚¹
            const startPoints = [
                { x: chipCenter.x, y: chipCenter.y - 60, dir: 'up' },    // ä¸Š
                { x: chipCenter.x + 60, y: chipCenter.y, dir: 'right' },  // å³
                { x: chipCenter.x, y: chipCenter.y + 60, dir: 'down' },   // ä¸‹
                { x: chipCenter.x - 60, y: chipCenter.y, dir: 'left' }    // å·¦
            ];
            
            // ç”Ÿæˆä¸»çº¿è·¯åˆ°æ¨¡å—
            generateMainLines(chipCenter);
            
            // ä»æ¯ä¸ªè¾¹ç”Ÿæˆå¤§é‡åˆ†æ”¯çº¿è·¯
            startPoints.forEach((start, i) => {
                // æ¯ä¸ªè¾¹ç”Ÿæˆ8-12æ¡åˆ†æ”¯çº¿è·¯
                const branchCount = 8 + Math.floor(Math.random() * 5);
                
                for (let j = 0; j < branchCount; j++) {
                    // å»¶è¿Ÿç”Ÿæˆæ¯æ¡çº¿è·¯
                    setTimeout(() => {
                        generateBranchLine(start, chipCenter, containerWidth, containerHeight, i * branchCount + j);
                    }, j * 50);
                }
            });
        }
        
        function generateMainLines(chipCenter) {
            const svg = document.getElementById('circuit-svg');
            const modules = [
                document.getElementById('tools-module'),
                document.getElementById('games-module'),
                document.getElementById('about-module'),
                document.getElementById('settings-module')
            ];
            
            modules.forEach((module, i) => {
                const rect = module.getBoundingClientRect();
                const end = {
                    x: rect.left + rect.width / 2,
                    y: rect.top + rect.height / 2
                };
                
                // åˆ›å»ºä¸»çº¿è·¯
                createLine(chipCenter, end, `main-${i}`, true);
            });
        }
        
        function generateBranchLine(start, chipCenter, maxWidth, maxHeight, id) {
            const svg = document.getElementById('circuit-svg');
            const points = [start];
            let currentPos = {...start};
            let currentDir = getInitialDirection(start.dir);
            let remainingLength = 150 + Math.random() * 300;
            let lastTurnDir = null;
            let turnCount = 0;
            
            // ç”Ÿæˆè·¯å¾„ç‚¹
            while (remainingLength > 0 && turnCount < 4) {
                const segmentLength = Math.min(
                    remainingLength,
                    50 + Math.random() * 100
                );
                
                // è®¡ç®—ä¸‹ä¸€ä¸ªç‚¹
                let nextPos = {
                    x: currentPos.x + Math.cos(currentDir) * segmentLength,
                    y: currentPos.y + Math.sin(currentDir) * segmentLength
                };
                
                // è¾¹ç•Œæ£€æŸ¥
                if (nextPos.x < 20 || nextPos.x > maxWidth - 20 ||
                    nextPos.y < 20 || nextPos.y > maxHeight - 20) {
                    break;
                }
                
                // éšæœºå†³å®šæ˜¯å¦è½¬å‘ (45åº¦)
                if (Math.random() > 0.7 && turnCount < 3) {
                    // ä¸èƒ½è¿ç»­ä¸¤ä¸ªç›¸åŒæ–¹å‘çš„è½¬å¼¯
                    let turnDir;
                    do {
                        turnDir = Math.random() > 0.5 ? 1 : -1;
                    } while (turnDir === lastTurnDir);
                    
                    currentDir += turnDir * Math.PI/4;
                    lastTurnDir = turnDir;
                    turnCount++;
                }
                
                points.push(nextPos);
                currentPos = nextPos;
                remainingLength -= segmentLength;
            }
            
            // åˆ›å»ºçº¿è·¯
            if (points.length > 1) {
                createLinePath(points, `branch-${id}`);
                
                // åœ¨ç»ˆç‚¹æ·»åŠ ç«¯ç‚¹
                const endPoint = points[points.length - 1];
                const circle = document.createElementNS("http://www.w3.org/2000/svg", "circle");
                circle.setAttribute("cx", endPoint.x);
                circle.setAttribute("cy", endPoint.y);
                circle.setAttribute("class", "end-point");
                circle.setAttribute("data-id", `point-${id}`);
                svg.appendChild(circle);
                
                // éšæœºå»¶è¿ŸåŠ¨ç”»
                circle.style.animationDelay = `${Math.random() * 0.5}s`;
            }
        }
        
        function getInitialDirection(dir) {
            switch(dir) {
                case 'up': return -Math.PI/2;
                case 'right': return 0;
                case 'down': return Math.PI/2;
                case 'left': return Math.PI;
                default: return 0;
            }
        }
        
        function createLine(start, end, id, isMain = false) {
            const svg = document.getElementById('circuit-svg');
            const line = document.createElementNS("http://www.w3.org/2000/svg", "path");
            
            // åˆ›å»ºç›´çº¿è·¯å¾„
            const pathData = `M${start.x},${start.y} L${end.x},${end.y}`;
            line.setAttribute("d", pathData);
            line.setAttribute("class", isMain ? "circuit-line main-line" : "circuit-line");
            line.setAttribute("id", `line-${id}`);
            line.setAttribute("stroke-dasharray", "1000");
            line.setAttribute("stroke-dashoffset", "1000");
            
            // è®¾ç½®åŠ¨ç”»å»¶è¿Ÿ
            line.style.animationDelay = `${Math.random() * 0.3}s`;
            svg.appendChild(line);
            
            // å¦‚æœæ˜¯ä¸»çº¿è·¯ï¼Œæ·»åŠ èƒ½é‡çº¿
            if (isMain) {
                const energyLine = line.cloneNode();
                energyLine.setAttribute("class", "circuit-line energy-line");
                energyLine.setAttribute("id", `energy-${id}`);
                energyLine.style.opacity = "0";
                svg.appendChild(energyLine);
            }
        }
        
        function createLinePath(points, id) {
            const svg = document.getElementById('circuit-svg');
            const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
            
            // æ„å»ºè·¯å¾„æ•°æ®
            let pathData = `M${points[0].x},${points[0].y}`;
            for (let i = 1; i < points.length; i++) {
                pathData += ` L${points[i].x},${points[i].y}`;
            }
            
            path.setAttribute("d", pathData);
            path.setAttribute("class", "circuit-line");
            path.setAttribute("id", `line-${id}`);
            path.setAttribute("stroke-dasharray", "1000");
            path.setAttribute("stroke-dashoffset", "1000");
            path.style.animationDelay = `${Math.random() * 0.3}s`;
            svg.appendChild(path);
        }
        
        function setupInteractions() {
            const modules = [
                document.getElementById('tools-module'),
                document.getElementById('games-module'),
                document.getElementById('about-module'),
                document.getElementById('settings-module')
            ];
            
            modules.forEach(module => {
                module.addEventListener('mouseenter', function() {
                    const energyLine = document.getElementById(`energy-main-${modules.indexOf(this)}`);
                    if (energyLine) energyLine.style.opacity = "1";
                });
                
                module.addEventListener('mouseleave', function() {
                    const energyLine = document.getElementById(`energy-main-${modules.indexOf(this)}`);
                    if (energyLine) energyLine.style.opacity = "0";
                });
                
                module.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // æ¿€æ´»æ•ˆæœ
                    const line = document.getElementById(`line-main-${modules.indexOf(this)}`);
                    if (line) line.classList.add('active-line');
                    
                    // è·³è½¬é€»è¾‘
                    setTimeout(() => {
                        switch(this.id) {
                            case 'tools-module':
                                window.location.href = 'https://tool-zmf.pages.dev';
                                break;
                            case 'games-module':
                                window.location.href = 'https://game-zmf.pages.dev';
                                break;
                            case 'about-module':
                                loadContent('/about/index.html');
                                break;
                            case 'settings-module':
                                loadContent('/setting/index.html');
                                break;
                        }
                    }, 800);
                });
            });
        }
        
        function loadContent(url) {
            // ä½¿ç”¨fetch APIåŠ è½½å†…å®¹
            fetch(url)
                .then(response => response.text())
                .then(html => {
                    // è¿™é‡Œå¯ä»¥å¤„ç†åŠ è½½çš„å†…å®¹
                    window.location.href = url;
                })
                .catch(err => {
                    console.error('åŠ è½½å†…å®¹å¤±è´¥:', err);
                    window.location.href = url;
                });
        }
        
        function startRandomActivations() {
            // éšæœºæ¿€æ´»çº¿è·¯å’Œç«¯ç‚¹
            setInterval(() => {
                // æ¿€æ´»éšæœºçº¿è·¯
                const lines = document.querySelectorAll('.circuit-line:not(.main-line)');
                const randomLine = lines[Math.floor(Math.random() * lines.length)];
                if (randomLine) {
                    randomLine.classList.add('active-line');
                    setTimeout(() => {
                        randomLine.classList.remove('active-line');
                    }, 2000 + Math.random() * 3000);
                }
                
                // æ¿€æ´»éšæœºç«¯ç‚¹
                const points = document.querySelectorAll('.end-point');
                const randomPoint = points[Math.floor(Math.random() * points.length)];
                if (randomPoint) {
                    randomPoint.classList.add('active-point');
                    setTimeout(() => {
                        randomPoint.classList.remove('active-point');
                    }, 1500 + Math.random() * 2500);
                }
            }, 800);
        }
    </script>
</body>
</html>
